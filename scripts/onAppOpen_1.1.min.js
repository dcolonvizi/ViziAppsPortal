function addPropertySelected(a, b) { addProperty(b, a.options[a.selectedIndex].label, a.value); a.selectedIndex = 0 } function addProperty(a, b, c) { if (b == undefined) return; var d = b.replaceAll(" ", "_").toLowerCase(); var e = document.getElementById(d); if (e != null) return; var f = d + "_delete"; var g = d + "_div"; $("#" + a).css("display", "none"); if (c != null && c.indexOf("-") >= 0) { $("#" + a).before('<div id="' + g + '"><table style="width: 600px"><tr><td align="left" valign="top" style="width:180px" >' + b + '</td><td valign="top"><input class="param" type="text" id="' + d + '" size="30" /></td><td>[' + c + ']</td><td style="width:20px"><img id="' + f + '" alt="delete" src="../../images/delete_small.gif"  /></td></tr></table></div>') } else if (c != null && c.indexOf("TEXTAREA") >= 0) { $("#" + a).before('<div id="' + g + '"><table style="width: 600px"><tr><td align="left" valign="top" style="width:180px" >' + b + '</td><td valign="top"><textarea class="param" rows="4" cols="50" id="' + d + '" size="30" ></textarea></td><td style="width:20px"><img id="' + f + '" alt="delete" src="../../images/delete_small.gif"  /></td></tr></table></div>') } else if (c != null && c != b && c.indexOf("NAME") < 0 && c != "URL") { var h = "<option>select -></option>"; var i = c.split(","); for (var j = 0; j < i.length; j++) { h += "<option>" + i[j] + "</option>" } $("#" + a).before('<div id="' + g + '"><table style="width: 600px"><tr><td align="left" valign="top" style="width:180px" >' + b + '</td><td valign="top"><select class="param" id="' + d + '" >"' + h + '"</select></td><td style="width:20px"><img id="' + f + '" alt="delete" src="../../images/delete_small.gif"  /></td></tr></table></div>') } else $("#" + a).before('<div id="' + g + '"><table style="width: 600px"><tr><td align="left" valign="top" style="width:180px" >' + b + '</td><td valign="top"><input class="param" type="text" id="' + d + '" size="30" /></td><td style="width:20px"><img id="' + f + '" alt="delete" src="../../images/delete_small.gif"  /></td></tr></table></div>'); $("#" + d).focus(); $("#" + d).change(function (d) { if (c != null && c != b) { var e = false; if (c.indexOf("TEXTAREA") >= 0) { } else if (c.indexOf("NAME") >= 0) { this.value = this.value.replaceAll(" ", "_"); if (!IsValidObjectName(this.value)) { alert('entry can only contain either a letter, number, "_" and be 1 to 100 characters long'); return } } else if (c == "URL") { this.value = this.value.replaceAll(" ", "%20"); if (this.value.indexOf("http://") != 0 && this.value.indexOf("https://") != 0) { alert("entry is not a valid URL"); return } } else if (c.indexOf("-") >= 0) { var f = c.split("-"); var g = parseInt(this.value); if (g >= parseInt(f[0]) && g <= parseInt(f[1])) { e = true } if (!e) { alert("entry is outside the valid range"); return } } else { var h = c.split(","); for (var i = 0; i < h.length; i++) { if (this.value == h[i].replaceAll(" ", "")) { e = true; break } } if (!e) { alert("entry does not match possible values"); return } } } d.cancelBubble = true; if (d.stopPropagation) d.stopPropagation(); $("#" + a).css("display", "block"); setActionValue() }); $("#" + f).click(function (b) { var c = b.target.attributes[2].value; var d = c.substring(0, c.length - 7) + "_div"; $("#" + d).remove(); $("#" + a).css("display", "block"); setActionValue() }) } function changeAction(a, b) { var c = null; switch (a.get_value()) { case "post": case "capture_process_document": case "manage_document_case": c = a.get_value() + "_view"; break; default: c = "no_view"; break } var d = document.getElementById("actionsMultiPage"); for (var e = 0; e < d.control._pageViewData.length; e++) { if (d.control._pageViewData[e].id == c) { d.control._selectPageViewByIndex(e); $(".param").each(function (a, b) { $(this).remove() }); return } } d.control._selectPageViewByIndex(0); $(".param").each(function (a, b) { $(this).remove() }) } function setComboValue(a, b) { if (a.control) { a.control.trackChanges(); var c = a.control.findItemByValue(b); if (c) { c.select() } a.control.commitChanges() } else { a.trackChanges(); var c = a.findItemByValue(b); if (c) { c.select() } a.commitChanges() } } function initDialog() { var a = document.getElementById("action_value"); if (a.value.length > 0) { var b = a.value.split(";"); var c = b[0].split(":"); var d = c[0]; var e = c[1].split(","); if (d == "capture_process_document") { for (var f = 0; f < e.length; f++) { var g = e[f].split("~"); var h = g[0].substring(0, 1).toUpperCase() + g[0].substring(1).replaceAll("_", " "); addProperty("addCaptureProcessDocumentPropertyDiv", h, null); $("#" + g[0]).attr("value", g[1].replaceAll("%3A", ":")) } $("#addCaptureProcessDocumentPropertyDiv").css("display", "block") } else if (d == "manage_document_case") { for (var f = 0; f < e.length; f++) { var g = e[f].split("~"); var h = g[0].substring(0, 1).toUpperCase() + g[0].substring(1).replaceAll("_", " "); if (h == "About box text") { addProperty("addManageDocumentCasePropertyDiv", h, "TEXTAREA"); $("#" + g[0]).attr("value", unescape(g[1])) } else { addProperty("addManageDocumentCasePropertyDiv", h, null); $("#" + g[0]).attr("value", g[1].replaceAll("%3A", ":")) } } $("#addManageDocumentCasePropertyDiv").css("display", "block") } } } function setActionValue() { var a = document.getElementById("actionsMultiPage"); var b = a.control.get_selectedPageView(); var c = b.get_id(); var d = document.getElementById("action_value"); if (c == "post_view") { d = ";" } else if (c == "capture_process_document_view") { d.value = "capture_process_document:"; error = false; $(".param").each(function (a, b) { if (b.value.length == 0) { alert("All parameters must have values."); error = true; return } if (a > 0) d.value += ","; d.value += b.id + "~" + b.value.replaceAll(":", "%3A") }); if (error) return; d.value += ";" } else if (c == "manage_document_case_view") { d.value = "manage_document_case:"; error = false; $(".param").each(function (a, b) { if (b.value.length == 0) { alert("All parameters must have values."); error = true; return } if (a > 0) d.value += ","; if (b.value.indexOf("<") >= 0 || b.value.indexOf("\n") >= 0) d.value += b.id + "~" + escape(b.value); else d.value += b.id + "~" + b.value.replaceAll(":", "%3A") }); if (error) return; d.value += ";" } else d.value = ""; var e = document.getElementById("docompute"); if (e.checked) { var f = document.getElementById("compute"); if (f.value == null || f.value == "") { alert("Compute field must be filled"); return } d.value += "compute:" + f.value.replaceAll("=", "~").replaceAll(";", "|").replaceAll(">", "#gt").replaceAll("<", "#lt") + "|" } } function PopUp(a, b) { var c = window.open(a, "_blank", b); if (c == null) { alert("For correct operation, popups need to be allowed from this website.") } } if (window.attachEvent) { window.attachEvent("onload", initDialog) } else if (window.addEventListener) { window.addEventListener("load", initDialog, false) } $(function () { })