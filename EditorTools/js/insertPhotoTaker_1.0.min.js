if(window.attachEvent){window.attachEvent("onload",initDialog)}else{if(window.addEventListener){window.addEventListener("load",initDialog,false)}}var ArgList=null;function initDialog(){ArgList=parent.window.getDialogInputArgs();for(var c=0;c<ArgList.length;c++){if(ArgList[c]==null){ArgList[c]=""}}if(ArgList[0].length>0){var e=document.getElementById("insertButtonID");e.value="Update Photo Taker";var f=document.getElementById("PhotoTakerName");f.value=ArgList[0];var j=document.getElementById("compression");j.value=ArgList[1];var d=document.getElementById("icon_field");var h=document.getElementById("icon_width");var g=document.getElementById("icon_height");if(ArgList[2]!=""){var a=ArgList[2].split(";");for(var c=0;c<a.length;c++){var b=a[c].split(":");switch(b[0]){case"field":d.value=b[1];break;case"width":h.value=b[1];break;case"height":g.value=b[1];break}}}else{d.value="";h.value="60";g.value="80"}style=ArgList[3]}}function IsNumeric(a){return/^-?(0|[1-9]\d*|(?=\.))(\.\d+)?$/.test(a)}function insertButton(){var e=document.getElementById("PhotoTakerName");if(e.value==null||e.value==""){alert("PhotoTaker Name is empty");return}if(!IsValidObjectName(e.value)){alert('PhotoTaker Name can only contain either a letter, number, space or "_" and be 1 to 100 characters long');return}e.value=e.value.replaceAll(" ","_");ArgList[0]=e.value;var c=document.getElementById("compression");if(c.value==null||c.value==""){alert("Compression field must be filled");return}if(!IsNumeric(c.value)){alert("Compression must be between 0.001 to 1.0");return}var b=parseFloat(c.value);if(b<0.0001||b>1){alert("Compression must be between 0.001 to 1.0");return}ArgList[1]=c.value;var d=document.getElementById("icon_field");var a=document.getElementById("icon_width");var f=document.getElementById("icon_height");if(d.value!=""){ArgList[2]="field:"+d.value+";width:"+a.value+";height:"+f.value}else{ArgList[2]=""}ArgList[3]=style;parent.window.InsertPhotoCallback(ArgList)};