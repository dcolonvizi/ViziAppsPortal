function OnClientRowTypeLoadHandler(a) { combo = a } function OnClientGoToPagesLoadHandler(a) { gotoPageCombo = a; if (gotoPage_do_select) { gotoPage_do_select = false; gotoPageCombo.trackChanges(); var b = gotoPageCombo.findItemByValue(gotoPage_selected_item); if (b && gotoPageCombo.get_value() != gotoPage_selected_item) { b.select() } else { var c = document.getElementById("newGoToPage"); newGotoPage.value = gotoPage_selected_item } gotoPageCombo.commitChanges() } if (table_options != undefined) { var d = table_options.split("|"); if (d.length == 1) { var e = document.getElementById("section1Options"); e.value = d[0].replaceAll(";", "\n") } else if (d.length == 2) { var f = document.getElementById("sections2Options1"); f.value = d[0].replaceAll(";", "\n"); var g = document.getElementById("sections2Options2"); g.value = d[1].replaceAll(";", "\n") } else if (d.length == 3) { var h = document.getElementById("sections3Options1"); h.value = d[0].replaceAll(";", "\n"); var i = document.getElementById("sections3Options2"); i.value = d[1].replaceAll(";", "\n"); var j = document.getElementById("sections3Options3"); j.value = d[2].replaceAll(";", "\n") } else if (d.length == 4) { var k = document.getElementById("sections4Options1"); k.value = d[0].replaceAll(";", "\n"); var l = document.getElementById("sections4Options2"); l.value = d[1].replaceAll(";", "\n"); var m = document.getElementById("sections4Options3"); m.value = d[2].replaceAll(";", "\n"); var n = document.getElementById("sections4Options4"); n.value = d[3].replaceAll(";", "\n") } table_options = undefined } } function tabSelected(a, b) { if (a.get_selectedIndex() == 1) { var c = document.getElementById("field_names"); var d = c.value.split(","); for (var e = 0; e < d.length; e++) { var f = e + 1; var g = "section" + f; var h = $("." + g); $("." + g).text(d[e]) } if (ArgList[4].length > 0) { table_options = ArgList[4]; var i = table_options.split("|"); if (i.length == 1) { var j = document.getElementById("section1Options"); j.value = i[0].replaceAll(";", "\n") } else if (i.length == 2) { var k = document.getElementById("sections2Options1"); k.value = i[0].replaceAll(";", "\n"); var l = document.getElementById("sections2Options2"); l.value = i[1].replaceAll(";", "\n") } else if (i.length == 3) { var m = document.getElementById("sections3Options1"); m.value = i[0].replaceAll(";", "\n"); var n = document.getElementById("sections3Options2"); n.value = i[1].replaceAll(";", "\n"); var o = document.getElementById("sections3Options3"); o.value = i[2].replaceAll(";", "\n") } else if (i.length == 4) { var p = document.getElementById("sections4Options1"); p.value = i[0].replaceAll(";", "\n"); var q = document.getElementById("sections4Options2"); q.value = i[1].replaceAll(";", "\n"); var r = document.getElementById("sections4Options3"); r.value = i[2].replaceAll(";", "\n"); var s = document.getElementById("sections4Options4"); s.value = i[3].replaceAll(";", "\n") } } } } function changeAction(a, b) { var c = null; switch (a.get_value()) { case "page_from_field": case "select": case "if_then_next_page": case "previous_page": case "next_page": case "post": case "call": case "share": case "email": case "sms": c = a.get_value() + "_view"; break; default: c = "no_view"; break } var d = document.getElementById("actionsMultiPage"); for (var e = 0; e < d.control._pageViewData.length; e++) { if (d.control._pageViewData[e].id == c) { d.control._selectPageViewByIndex(e); $(".param").each(function (a, b) { $(this).remove() }); return } } d.control._selectPageViewByIndex(0); $(".param").each(function (a, b) { $(this).remove() }) } function setComboValue(a, b) { if (a.control) { a.control.trackChanges(); var c = a.control.findItemByValue(b); if (c) { c.select() } a.control.commitChanges() } else { a.trackChanges(); var c = a.findItemByValue(b); if (c) { c.select() } a.commitChanges() } } function OnClientGoToPagesLoadHandler(a) { gotoPageCombo = a } function OnClientpage_if_trueLoadHandler(a) { page_if_true = a } function OnClientpage_if_falseLoadHandler(a) { page_if_false = a } function GoToPages_SelectedIndexChanged(a, b) { next_page_value = a.get_text() } function next_page_condition_Changed(a, b) { next_page_condition_value = a.value } function page_if_true_SelectedIndexChanged(a, b) { page_if_true_value = a.get_text() } function page_if_false_SelectedIndexChanged(a, b) { page_if_false_value = a.get_text() } function contains(a, b) { return a.indexOf(b) >= 0 ? true : false } function addPropertySelected(a, b) { addProperty(b, a.options[a.selectedIndex].label, a.value); a.selectedIndex = 0 } function addProperty(a, b, c) { if (b == undefined) return; var d = b.replaceAll(" ", "_").toLowerCase(); var e = document.getElementById(d); if (e != null) return; var f = d + "_delete"; var g = d + "_div"; $("#" + a).css("display", "none"); if (c != null && c.indexOf("-") >= 0) { $("#" + a).before('<div id="' + g + '"><table style="width: 600px"><tr><td align="left" valign="top" style="width:180px" >' + b + '</td><td valign="top"><input class="param" type="text" id="' + d + '" size="30" /></td><td>[' + c + ']</td><td style="width:20px"><img id="' + f + '" alt="delete" src="../images/delete_small.gif"  /></td></tr></table></div>') } else if (c != null && c.indexOf("TEXTAREA") >= 0) { $("#" + a).before('<div id="' + g + '"><table style="width: 600px"><tr><td align="left" valign="top" style="width:180px" >' + b + '</td><td valign="top"><textarea class="param" rows="4" cols="50" id="' + d + '" size="30" ></textarea></td><td style="width:20px"><img id="' + f + '" alt="delete" src="../images/delete_small.gif"  /></td></tr></table></div>') } else if (c != null && c != b && c.indexOf("NAME") < 0 && c != "URL") { var h = "<option>select -></option>"; var i = c.split(","); for (var j = 0; j < i.length; j++) { h += "<option>" + i[j] + "</option>" } $("#" + a).before('<div id="' + g + '"><table style="width: 600px"><tr><td align="left" valign="top" style="width:180px" >' + b + '</td><td valign="top"><select class="param" id="' + d + '" >"' + h + '"</select></td><td style="width:20px"><img id="' + f + '" alt="delete" src="../images/delete_small.gif"  /></td></tr></table></div>') } else $("#" + a).before('<div id="' + g + '"><table style="width: 600px"><tr><td align="left" valign="top" style="width:180px" >' + b + '</td><td valign="top"><input class="param" type="text" id="' + d + '" size="30" /></td><td style="width:20px"><img id="' + f + '" alt="delete" src="../images/delete_small.gif"  /></td></tr></table></div>'); $("#" + d).focus(); $("#" + d).change(function (d) { if (c != null && c != b) { var e = false; if (c.indexOf("TEXTAREA") >= 0) { } else if (c.indexOf("NAME") >= 0) { this.value = this.value.replaceAll(" ", "_"); if (!IsValidObjectName(this.value)) { alert('entry can only contain either a letter, number, "_" and be 1 to 100 characters long'); return } } else if (c == "URL") { this.value = this.value.replaceAll(" ", "%20"); if (this.value.indexOf("http://") != 0 && this.value.indexOf("https://") != 0) { alert("entry is not a valid URL"); return } } else if (c.indexOf("-") >= 0) { var f = c.split("-"); var g = parseInt(this.value); if (g >= parseInt(f[0]) && g <= parseInt(f[1])) { e = true } if (!e) { alert("entry is outside the valid range"); return } } else { var h = c.split(","); for (var i = 0; i < h.length; i++) { if (this.value == h[i].replaceAll(" ", "")) { e = true; break } } if (!e) { alert("entry does not match possible values"); return } } } d.cancelBubble = true; if (d.stopPropagation) d.stopPropagation(); $("#" + a).css("display", "block") }); $("#" + f).click(function (b) { var c = b.target.attributes[2].value; var d = c.substring(0, c.length - 7) + "_div"; $("#" + d).remove(); $("#" + a).css("display", "block") }) } function initDialog() { ArgList = parent.window.getDialogInputArgs(); for (var a = 0; a < ArgList.length; a++) { if (ArgList[a] == null) ArgList[a] = "" } var b = document.getElementById("tableName"); b.value = ArgList[0]; if (ArgList[0].length > 0) { var c = document.getElementById("insertButtonID"); c.value = "Update Table"; var d = document.getElementById("tableDisplayName"); if (ArgList[1].length > 0) d.value = ArgList[1]; else d.value = ArgList[0]; var e = document.getElementById("actionsMultiPage"); var f = document.getElementById("actions"); var g = document.getElementsByName("view_response"); var h = ArgList[2].split(":"); do_select = true; selected_item = h[0]; if (combo.get_value() != selected_item) { setComboValue(combo, selected_item) } var i = document.getElementById("field_names"); i.value = h[1]; var j = ArgList[3].split(";"); for (var a = 0; a < j.length; a++) { var h = j[a].split(":"); switch (h[0]) { case "post": setComboValue(f, "post"); break; case "next_page": gotoPage_do_select = true; var k = h[1].split("~"); gotoPage_selected_item = k[1]; setComboValue(f, "next_page"); gotoPageCombo = document.getElementById("GoToPages").control; if (gotoPageCombo.get_text() != gotoPage_selected_item) { gotoPageCombo.trackChanges(); gotoPageCombo.set_text(gotoPage_selected_item); gotoPageCombo.commitChanges() } break; case "page_from_field": setComboValue(f, "page_from_field"); break; case "if_then_next_page": gotoPage_do_select = true; setComboValue(f, "if_then_next_page"); var l = h[1].split(","); var m = l[0].split("~"); var n = document.getElementById("next_page_condition"); n.value = m[1].replaceAll("#gt", ">").replaceAll("#lt", "<").replaceAll("#eq", "="); page_if_true.trackChanges(); m = l[1].split("~"); page_if_true.set_text(m[1]); page_if_true.commitChanges(); page_if_false.trackChanges(); m = l[2].split("~"); page_if_false.set_text(m[1]); page_if_false.commitChanges(); break; case "previous_page": setComboValue(f, "previous_page"); break; case "select": var o = document.getElementById("count_field"); var p = h[1].split("~"); if (p != null && p.length > 1) o.value = p[1]; setComboValue(f, "select"); break; case "call": var q = document.getElementById("device_field"); var r = h[1].split("~"); q.value = r[1]; setComboValue(f, "call"); break; case "share": setComboValue(f, "share"); var s = h[1].split(","); for (var t = 0; t < s.length; t++) { var u = s[t].split("~"); var v = u[0].substring(0, 1).toUpperCase() + u[0].substring(1).replaceAll("_", " "); addProperty("addSharePropertyDiv", v, null); $("#" + u[0]).attr("value", u[1].replaceAll("%3A", ":")) } $("#addSharePropertyDiv").css("display", "block"); break; case "email": setComboValue(f, "email"); var s = h[1].split(","); for (var t = 0; t < s.length; t++) { var u = s[t].split("~"); var v = u[0].substring(0, 1).toUpperCase() + u[0].substring(1).replaceAll("_", " "); addProperty("addEmailPropertyDiv", v, null); $("#" + u[0]).attr("value", u[1].replaceAll("%3A", ":")) } $("#addEmailPropertyDiv").css("display", "block"); break; case "sms": setComboValue(f, "sms"); var s = h[1].split(","); for (var t = 0; t < s.length; t++) { var u = s[t].split("~"); var v = u[0].substring(0, 1).toUpperCase() + u[0].substring(1).replaceAll("_", " "); addProperty("addSMSPropertyDiv", v, null); $("#" + u[0]).attr("value", u[1].replaceAll("%3A", ":")) } $("#addSMSPropertyDiv").css("display", "block"); break; case "compute": var w = document.getElementById("compute"); w.value = h[1].replaceAll("~", "=").replaceAll("|", ";"); var x = document.getElementById("docompute"); x.checked = true; break; default: break } } table_options = ArgList[4]; var y = table_options.split("|"); if (y.length == 1) { var z = document.getElementById("section1Options"); z.value = y[0].replaceAll(";", "\n") } else if (y.length == 2) { var A = document.getElementById("sections2Options1"); A.value = y[0].replaceAll(";", "\n"); var B = document.getElementById("sections2Options2"); B.value = y[1].replaceAll(";", "\n") } else if (y.length == 3) { var C = document.getElementById("sections3Options1"); C.value = y[0].replaceAll(";", "\n"); var D = document.getElementById("sections3Options2"); D.value = y[1].replaceAll(";", "\n"); var E = document.getElementById("sections3Options3"); E.value = y[2].replaceAll(";", "\n") } else if (y.length == 4) { var F = document.getElementById("sections4Options1"); F.value = y[0].replaceAll(";", "\n"); var G = document.getElementById("sections4Options2"); G.value = y[1].replaceAll(";", "\n"); var H = document.getElementById("sections4Options3"); H.value = y[2].replaceAll(";", "\n"); var I = document.getElementById("sections4Options4"); I.value = y[3].replaceAll(";", "\n") } style = ArgList[5] } } function FilterOptions(a) { var b = a.replaceAll("\r\n", ";").replaceAll("\n", ";").replaceAll(";;", ";"); if (b.charAt(b.length - 1) == ";") return b.substring(0, b.length - 1); else return b } function insertButton() { var a = document.getElementById("tableName"); if (a.value == null || a.value == "") { alert("Internal Table Name must be filled"); return } if (!IsValidObjectName(a.value)) { alert('Table Name can only contain either a letter, number, space or "_" and be 1 to 100 characters long'); return } a.value = a.value.replaceAll(" ", "_"); ArgList[0] = a.value; var b = document.getElementById("tableDisplayName"); if (b.value == null || b.value == "") { alert("Table Display Name must be filled"); return } ArgList[1] = b.value; var c = document.getElementById("field_names"); if (c.value == null || c.value == "") { alert("No Field Names"); return } c.value = c.value.replaceAll(" ", "_"); var d = c.value.split(","); var e = d.length; var f = combo.get_value(); var g = "The number of fields for the selected table row type do not match"; switch (f) { case "1text|text": if (e != 1) { alert(g); return } break; case "2texts|text,text": case "1texthidden|text,hidden": case "imagetext|image,text": case "image1text|image,text": if (e != 2) { alert(g); return } break; case "2textshidden|text,text,hidden": case "image1texthidden|image,text,hidden": case "image2texts|image,text,text": if (e != 3) { alert(g); return } break; case "image2textshidden|image,text,text,hidden": if (e != 4) { alert(g); return } break } ArgList[2] = combo.get_value() + ":"; var h = true; for (var i = 0; i < d.length; i++) { d[i] = d[i].trim().replaceAll(" ", "_"); if (a.value == d[i]) { alert("The Table Name and the Table Field Name " + d[i] + " cannot be the same"); return } if (h) h = false; else ArgList[2] += ","; ArgList[2] += d[i] } var j = document.getElementById("actionsMultiPage"); var k = j.control.get_selectedPageView(); var l = k.get_id(); if (l == "next_page_view") { next_page_value = document.getElementById("GoToPages").control.get_text(); if (next_page_value == null || next_page_value.length == 0 || contains(next_page_value, "Choose Field or Enter")) { alert("The name of the next page must be set"); return } ArgList[3] = "next_page:page~" + next_page_value.replaceAll(" ", "_") + ";" } else if (l == "page_from_field_view") { if (f == "1texthidden|text,hidden" || f == "2textshidden|text,text,hidden" || f == "image1texthidden|image,text,hidden" || f == "image2textshidden|image,text,text,hidden") { ArgList[3] = "page_from_field:field~" + d[d.length - 1] + ";" } else { alert("The action you chose requires a row type with a hidden field."); return } } else if (l == "if_then_next_page_view") { var m = document.getElementById("next_page_condition"); next_page_condition_value = m.value; var n = document.getElementById("page_if_true"); page_if_true_value = n.control.get_text(); var o = document.getElementById("page_if_false"); page_if_false_value = o.control.get_text(); if (next_page_condition_value == null || next_page_condition_value.length == 0) { alert("The if condition must be set"); return } if (!contains(next_page_condition_value, ">") && !contains(next_page_condition_value, "<") && !contains(next_page_condition_value, "=")) { alert("The if condition must contain a logical operation"); return } if (page_if_true_value.length == 0 || contains(page_if_true_value, "Choose Field or Enter")) { alert("The page for the true condition must be set"); return } if (page_if_false_value.length == 0 || contains(page_if_false_value, "Choose Field or Enter")) { alert("The page for the false condition must be set"); return } ArgList[3] = "if_then_next_page:next_page_condition_value~" + next_page_condition_value.replaceAll("<", "#lt").replaceAll(">", "#gt").replaceAll("=", "#eq") + ",page_if_true_value~" + page_if_true_value.replaceAll(" ", "_") + ",page_if_false_value~" + page_if_false_value.replaceAll(" ", "_") + ";" } else if (l == "previous_page_view") { ArgList[3] = "previous_page;" } else if (l == "select_view") { var p = document.getElementById("count_field"); ArgList[3] = "select:count_field~" + p.value.replaceAll(" ", "_") + ";" } else if (l == "post_view") { ArgList[3] = "post:;" } else if (l == "call_view") { var q = document.getElementById("device_field"); if (q.value.length == 0) { alert("The name of the phone field must be set."); return } ArgList[3] = "call:phone_field~" + q.value.replaceAll(" ", "_") + ";" } else if (l == "share_view") { ArgList[3] = "share:"; error = false; $(".param").each(function (a, b) { if (b.value.length == 0) { alert("All parameters must have values."); error = true; return } if (a > 0) ArgList[3] += ","; ArgList[3] += b.id + "~" + b.value.replaceAll(":", "%3A") }); if (error) return; ArgList[3] += ";" } else if (l == "email_view") { ArgList[3] = "email:"; error = false; $(".param").each(function (a, b) { if (b.value.length == 0) { alert("All parameters must have values."); error = true; return } if (a > 0) ArgList[3] += ","; ArgList[3] += b.id + "~" + b.value.replaceAll(":", "%3A") }); if (error) return; ArgList[3] += ";" } else if (l == "sms_view") { ArgList[3] = "sms:"; error = false; $(".param").each(function (a, b) { if (b.value.length == 0) { alert("All parameters must have values."); error = true; return } if (a > 0) ArgList[3] += ","; ArgList[3] += b.id + "~" + b.value.replaceAll(":", "%3A") }); if (error) return; ArgList[3] += ";" } else ArgList[3] = ""; var r = document.getElementById("docompute"); if (r.checked) { var s = document.getElementById("compute"); if (s.value == null || s.value == "") { alert("Compute field must be filled"); return } ArgList[3] += "compute:" + s.value.replaceAll("=", "~").replaceAll(";", "|") + ";" } var t = document.getElementById("options"); var u = "|"; var v = document.getElementById("SectionPages"); var w = v.control.get_selectedIndex(); if (w == 0) { t.value = FilterOptions(document.getElementById("section1Options").value) } else if (w == 1) { var x = FilterOptions(document.getElementById("sections2Options1").value); var y = getNOptions(x); var z = FilterOptions(document.getElementById("sections2Options2").value); var A = getNOptions(z); if (y > 0 || A > 0) { if (y != A) { alert("The number of field options in field 1 (" + y + ") does not equal the number of field options in field 2 (" + A + ")"); return } t.value = x + u + z } } else if (w == 2) { var x = FilterOptions(document.getElementById("sections3Options1").value); var y = getNOptions(x); var z = FilterOptions(document.getElementById("sections3Options2").value); var A = getNOptions(z); var B = FilterOptions(document.getElementById("sections3Options3").value); var C = getNOptions(B); if (y > 0 || A > 0 || C > 0) { if (y != A || y != C) { alert("The number of field options in the fields do not  match: " + y + ", " + A + ", " + C); return } t.value = x + u + z + u + B } } else if (w == 3) { var x = FilterOptions(document.getElementById("sections4Options1").value); var y = getNOptions(x); var z = FilterOptions(document.getElementById("sections4Options2").value); var A = getNOptions(z); var B = FilterOptions(document.getElementById("sections4Options3").value); var C = getNOptions(B); var D = FilterOptions(document.getElementById("sections4Options4").value); var E = getNOptions(D); if (y > 0 || A > 0 || C > 0 || E > 0) { if (y != A || y != C || y != E) { alert("The number of field options in the fields do not  match: " + y + ", " + A + ", " + C + ", " + E); return } t.value = x + u + z + u + B + u + B } } ArgList[4] = t.value; ArgList[5] = style; parent.window.InsertTableCallback(ArgList) } function getNOptions(a) { if (a.length == 0) return 0; var b = 1; for (var c = 0; c < a.length; c++) { if (a.charAt(c) == ";") { b++ } } return b } if (window.attachEvent) { window.attachEvent("onload", initDialog) } else if (window.addEventListener) { window.addEventListener("load", initDialog, false) } var ArgList = null; var combo; var do_select = false; var selected_item; var gotoPageCombo; var gotoPage_do_select = false; var table_options; var gotoPage_selected_item; $(document).ready(function () { }); var gotoPageCombo; var page_if_true; var page_if_false; var next_page_value; var next_page_condition_value; var page_if_true_value; var page_if_false_value; $(function () { })